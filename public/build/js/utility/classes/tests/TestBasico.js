import Test from"./Test.js";import UI from"../../../layout/UI.js";const testContenedor=document.querySelector("#test-formulario");export default class TestBasico extends Test{constructor(e={}){super(e)}calcularNumOpciones(){return this.opciones.length}calcularMinimoYMaximo(){const e=this.opciones.map(e=>parseInt(e.valor)),t=Math.max(...e)*this.preguntas.length;if(0===this.instrucciones.length){return{maximo:t,minimo:Math.min(...e)}}return{maximo:t}}mostrarModificarOpcion(e,t){const{opcion:n,valor:o,id:a}=e,c=document.createElement("DIV"),i=document.createElement("FORM");i.classList.add("formulario","formulario-modal");const r=document.createElement("DIV"),d=document.createElement("LABEL"),l=document.createElement("INPUT");r.classList.add("campo"),d.setAttribute("for","opcion-modal"),d.textContent=`Opcion ${t}: `,l.type="text",l.name="opcion-modal",l.id="opcion-modal",l.placeholder="Nueva Opcion",l.value=n,r.appendChild(d),r.appendChild(l);const s=document.createElement("DIV"),p=document.createElement("LABEL"),m=document.createElement("INPUT");s.classList.add("campo"),p.setAttribute("for","valor-modal"),p.textContent="Valor: ",m.name="valor-modal",m.id="valor-modal",m.placeholder="Valor de la Opcion",m.type="number",m.min=1,m.max=10,m.value=o,s.appendChild(p),s.appendChild(m);const u=document.createElement("BUTTON");u.type="submit",u.textContent="Guardar Cambios",u.classList.add("boton-verde"),i.appendChild(r),i.appendChild(s),i.appendChild(u),i.onsubmit=e=>{e.preventDefault(),this.validarOpcion(e.target,a)},c.appendChild(i),UI.crearModal(c)}mostrarModalOpciones(){const e=document.createElement("DIV"),{opciones:t}=this,n=document.createElement("H2");n.textContent="Opciones: ";const o=document.createElement("DIV");if(o.classList.add("seccion","contenedor-opciones"),0===t.length){const e=document.createElement("P");e.textContent="No Hay Opciones",o.appendChild(e)}else t.forEach((e,t)=>{const{opcion:n,valor:a,id:c}=e,i=document.createElement("LI"),r=document.createElement("SPAN"),d=document.createElement("SPAN"),l=document.createElement("P");r.textContent=`Opcion ${t+1}: `,d.textContent=n,l.textContent="Valor: "+a;const s=document.createElement("SPAN");s.classList.add("acciones"),s.innerHTML='\n                    <button type="button" class="boton-naranja" id="actualizar-opcion">Modificar</button>\n                    <button type="button" class="boton-rojo" id="eliminar-opcion">Eliminar</button>\n                ',s.onclick=n=>{"actualizar-opcion"===n.target.id&&this.mostrarModificarOpcion({...e},t+1),"eliminar-opcion"===n.target.id&&this.mostrarEliminarOpcion(c)},i.appendChild(r),i.appendChild(d),i.appendChild(l),i.appendChild(s),o.appendChild(i)});e.appendChild(n),e.appendChild(o),UI.crearModal(e)}mostrarFormulario(){const{preguntas:e,opciones:t}=this.test;Object.entries(e).forEach(([e,n])=>{const o=document.createElement("DIV");o.classList.add("campo-radio");const a=document.createElement("P");a.classList.add("pregunta"),a.dataset.idPregunta=e,a.id=e,a.textContent=n;const c=document.createElement("DIV");c.classList.add("opciones-test"),Object.entries(t).forEach(([t,{valor:n,opcion:o}])=>{const a=document.createElement("DIV");a.classList.add("radio");const i=document.createElement("INPUT");i.type="radio",i.name=t,i.id=`${e}_${t}`,i.dataset.idPregunta=e,i.dataset.valor=n;const r=document.createElement("LABEL");r.setAttribute("for",`${e}_${t}`),r.textContent=o,a.appendChild(i),a.appendChild(r),c.appendChild(a)}),o.appendChild(a),o.appendChild(c),testContenedor.appendChild(o)})}formulario2(e){const t=this.preguntas.length+1,n=document.createElement("DIV"),o=document.createElement("DIV"),a=document.createElement("LABEL"),c=document.createElement("INPUT");n.classList.add("campo-pregunta","seccion"),o.classList.add("campo"),a.textContent=`Pregunta ${t}: `,a.setAttribute("for","pregunta"),c.placeholder="Nueva Pregunta",c.id="pregunta",c.name="pregunta",c.type="text",o.appendChild(a),o.appendChild(c),n.appendChild(o);const i=document.createElement("BUTTON");i.type="button",i.textContent="Agregar Pregunta",i.classList.add("boton-verde"),i.onclick=e=>{this.validarPregunta(e.target.parentElement)},n.appendChild(i);const r=this.opciones.length+1,d=document.createElement("DIV"),l=document.createElement("DIV"),s=document.createElement("LABEL"),p=document.createElement("INPUT");d.classList.add("campo-opcion","seccion"),l.classList.add("campo"),s.setAttribute("for","opcion"),s.textContent=`Opcion ${r}: `,p.type="text",p.name="opcion",p.id="opcion",p.placeholder="Nueva Opcion";const m=document.createElement("DIV"),u=document.createElement("LABEL"),h=document.createElement("INPUT");m.classList.add("campo"),u.setAttribute("for","valor"),u.textContent="Valor: ",h.name="valor",h.id="valor",h.placeholder="Valor de la Opcion",h.type="number",h.min=1,h.max=10;const C=document.createElement("BUTTON");C.type="button",C.textContent="Agregar Opcion",C.classList.add("boton-verde"),C.onclick=e=>{this.validarOpcion(e.target.parentElement)},l.appendChild(s),l.appendChild(p),m.appendChild(u),m.appendChild(h),d.appendChild(l),d.appendChild(m),d.appendChild(C),e.appendChild(n),e.appendChild(d)}validarOpcion(e,t){const n=e.querySelector(t?".campo #opcion-modal":".campo #opcion"),o=n.value.trim(),a=e.querySelector(t?".campo #valor-modal":".campo #valor"),c=a.value.trim();if(""===o||""===c)return void UI.mostrarAlerta("Todos los Campos Son Obligatorios",e);if(isNaN(c)||c<1||c>10)return void UI.mostrarAlerta("Valor Invalido",e);if(t){const e={id:t,opcion:o,valor:c};return this.modificarOpcion(e),this.mostrarModalOpciones(),this.cambiarPagina(2),this.validarMaximoInstrucciones(),void Swal.fire({title:"Exito",text:"Se Actualizo la Opcion",icon:"success"})}const i={id:Date.now(),opcion:o,valor:c};this.agregarOpcion(i),n.value="",a.value="",n.previousElementSibling.textContent=`Opcion ${this.opciones.length+1}: `,UI.mostrarAlerta("La Opcion se Agrego Correctamente",e,"exito")}}